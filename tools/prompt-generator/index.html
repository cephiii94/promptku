<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Builder - Promptku</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <link rel="stylesheet" href="../../css/variables.css">
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="../../css/layout.css">
    <link rel="stylesheet" href="../../css/components.css">
    <!-- <link rel="stylesheet" href="../../styles.css">  -->
    <link rel="stylesheet" href="builder-styles.css">

    <link rel="icon" type="image/png" sizes="32x32" href="../../img/favicon-32x32.png">
</head>
<body>

    <header class="sticky-header pinterest-style">
        
        <div class="header-left">

            <!-- Back Button inline for Generator -->
             <a href="../tools.html" class="icon-btn" style="margin-left: 8px; text-decoration: none; color: inherit;">
                <span class="material-icons">arrow_back</span>
            </a>
        </div>

        <div class="header-center">
            <div class="header-title-mobile-only" style="font-weight: 600; font-size: 1.1rem;">
                AI Prompt Builder
            </div>
        </div>

        <div class="header-right">
            
            <div id="auth-buttons-desktop" class="auth-buttons-desktop">
                <a href="../../index.html" class="pinterest-btn btn-primary" style="text-decoration: none;">Log Masuk</a>
            </div>

            <div id="user-profile-desktop" class="user-profile-wrapper" style="display: none;">
                
                <!-- Saldo Header -->
                <a href="../../pricing.html" id="header-user-balance" class="balance-link" style="margin-right: 12px; font-weight: 600; font-size: 0.9rem; display: flex; align-items: center; color: #059669; background: #ecfdf5; padding: 6px 12px; border-radius: 20px; text-decoration: none; border: 1px solid transparent; transition: all 0.2s;">
                    <span class="material-icons" style="font-size: 16px; margin-right: 4px;">account_balance_wallet</span> ...
                </a>
                <style>
                    .balance-link:hover {
                        background: #d1fae5 !important;
                        border-color: #10B981 !important;
                        transform: translateY(-1px);
                    }
                </style>

                <a href="../../profile.html" class="profile-icon-container tooltip-container">
                    <img id="header-avatar" src="https://placehold.co/100x100/e3f2fd/1e3a5a?text=U" alt="User">
                    <span class="tooltip">Lihat Profil</span>
                </a>

                <button id="profile-dropdown-trigger" class="icon-btn-pinterest">
                    <span class="material-icons">keyboard_arrow_down</span>
                </button>

                <div id="profile-dropdown-menu" class="dropdown-menu">
                    <div class="dropdown-header">
                        <p class="dropdown-label">Sedang login sebagai:</p>
                        <h4 id="dropdown-username">Nama User</h4>
                        <p id="dropdown-email">user@email.com</p>
                    </div>
                    <hr>
                    <a href="../../profile.html" class="dropdown-item">
                        <span class="material-icons">person</span> Lihat Profil
                    </a>
                    <a href="#" id="logout-btn-desktop" class="dropdown-item text-danger">
                        <span class="material-icons">logout</span> Keluar
                    </a>
                </div>
            </div>

        </div>
    </header>

    <div class="container" style="margin-top: 80px;">
        <main class="generator-container">
            
            <header class="builder-header">
                <h2>Bantu AI Memahami Anda</h2>
                <p>Bantu Gemini Banana memahami keinginan Anda dengan prompt terstruktur.</p>
            </header>
            
            <div class="guide-button-container">
                <button id="openModalButton" class="btn-link">
                    Cara Menggunakan (?)
                </button>
            </div>


            <form id="prompt-form">
                <div class="form-group">
                    <label for="corePrompt">1. Prompt Inti (Subjek Utama)</label>
                    <textarea id="corePrompt" rows="3" placeholder="Misal: 'Seorang wanita', 'Dua anak laki-laki', 'Sebuah kastil di atas bukit'"></textarea>
                    <p class="helper-text">Jelaskan subjek utama atau perintah pengeditan utama.</p>
                </div>

                <div class="form-group">
                    <label>2. Detail Karakter (Opsional)</label>
                    <p class="helper-text" style="margin-bottom: 0.75rem;">Gunakan 'Link Gambar Referensi Wajah' untuk membantu AI mengenali wajah tertentu.</p>
                    <div id="characterContainer">
                        </div>
                    <button type="button" id="addCharacterButton" class="auth-button reset-btn" style="padding: 0.5rem 1rem; margin-top: 0.75rem; width: auto;">
                        <span class="material-icons" style="font-size: 18px;">add</span>
                        <span>Tambah Karakter</span>
                    </button>
                </div>

                <div class="form-group">
                    <label for="actionDetails">3. Aksi & Interaksi (Opsional)</label>
                    <textarea id="actionDetails" rows="2" placeholder="Misal: sedang berlari, tertawa bersama teman, membaca buku di bawah pohon"></textarea>
                </div>

                <div class="form-group">
                    <label for="atmosphereDetails">4. Suasana & Latar (Opsional)</label>
                    <textarea id="atmosphereDetails" rows="2" placeholder="Misal: di kafe yang ramai, malam hari, hujan, pencahayaan neon, berkabut"></textarea>
                </div>

                <div class="form-group">
                    <label for="styleMedium">5. Gaya & Medium</label>
                    <select id="styleMedium">
                        <option value="">-- Pilih Gaya (Opsional) --</option>
                        <option value="photorealistic">Fotorealistis (Nyata)</option>
                        <option value="digital art">Seni Digital (Digital Art)</option>
                        <option value="watercolor painting">Lukisan Cat Air</option>
                        <option value="oil painting">Lukisan Cat Minyak</option>
                        <option value="anime style">Gaya Anime / Manga</option>
                        <option value="3D render">3D Render (Seperti Pixar)</option>
                        <option value="pixel art">Pixel Art</option>
                        <option value="line art">Line Art (Sketsa Garis)</option>
                        <option value="in the style of Van Gogh">Gaya Van Gogh</option>
                        <option value="in the style of Picasso">Gaya Picasso</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="quality">6. Kualitas & Resolusi</label>
                    <textarea id="quality" rows="2" placeholder="Misal: '4k', 'sangat detail', 'tajam', 'kualitas tinggi'"></textarea>
                    <p class="helper-text">Seringkali 'highly detailed' atau '4k' sudah cukup.</p>
                </div>

                <div class="form-group">
                    <label for="negative">7. Prompt Negatif (Hindari Ini)</label>
                    <textarea id="negative" rows="2" placeholder="Misal: 'buram', 'Teks', 'watermark', 'kualitas rendah', 'tangan jelek'"></textarea>
                </div>

                <button type="submit" id="generateButton" class="auth-button generate-btn" style="width: 100%; margin-top: 1rem;">
                    <span id="loadingSpinner" class="material-icons spin hidden" style="margin-right: 0.5rem;">autorenew</span>
                    <span id="buttonText">Buat Prompt Cerdas (AI)</span>
                </button>
            </form>
            <div class="form-group" style="margin-top: 2rem; border-top: 1px solid var(--light-gray-border); padding-top: 2rem;">
                
                <div class="form-label-wrapper">
                    <label for="finalPrompt">Hasil Prompt (Siap Digunakan):</label>
                    
                    <button type="button" id="copyButton" class="auth-button reset-btn hidden" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">
                        <span class="material-icons" style="font-size: 16px;">content_copy</span>
                        <span id="copyButtonText">Salin</span>
                    </button>
                </div>

                <div class="textarea-wrapper"> 
                    
                    <div id="resultLoader" class="hidden">
                        <div class="typing-indicator">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
            
                    <textarea id="finalPrompt" rows="5" readonly placeholder="Hasil prompt akan muncul di sini..."></textarea>
                    
                </div>
            </div>

        </main>
    </div>

    <footer class="site-footer" style="margin-top: 2rem; border-top: 1px solid #e5e7eb; padding-top: 1.5rem;">
        <div class="container" style="text-align: center;">
            <p style="color: #6b7280; font-size: 0.875rem;">&copy; <span id="current-year"></span> Galeri Prompt Banana | <a href="../../terms.html" style="color: inherit; text-decoration: none;">S&K</a></p>
        </div>
    </footer>

    <div id="howToModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Cara Menggunakan</h2>
                <button id="closeModalButton" class="close-btn">&times;</button>
            </div>
            
            <div class="modal-body" style="padding-top: 1rem;">
                <p>Tool ini membantu Anda membuat prompt teks yang deskriptif untuk AI Gambar (Gemini Banana) dari input yang sederhana.</p>
                
                <div style="margin-top: 1rem;">
                    <strong style="font-weight: 600; color: var(--text-dark);">Alur Penggunaan Dasar:</strong>
                    <ol style="list-style: decimal; padding-left: 1.5rem; margin-top: 0.5rem; display: flex; flex-direction: column; gap: 0.25rem;">
                        <li><strong>Prompt Inti:</strong> Isi dengan subjek utama adegan.</li>
                        <li><strong>Detail Karakter:</strong> Klik "Tambah Karakter (+)" untuk setiap karakter utama.</li>
                        <li><strong>Aksi & Suasana:</strong> Jelaskan apa yang terjadi dan bagaimana suasananya.</li>
                        <li><strong>Gaya & Kualitas:</strong> Pilih gaya (misal: "Fotorealistis") dan kualitas.</li>
                        <li>Klik <strong>"Buat Prompt Cerdas (AI)"</strong>.</li>
                    </ol>
                </div>

                <div class="modal-notice-box">
                    <strong>PENTING: Cara Menggunakan Referensi Wajah</strong>
                    <p>Agar AI bisa menghasilkan wajah yang mirip (misal: Vanno atau Varren):</p>
                    <ol style="list-style: decimal; padding-left: 1.5rem; margin-top: 0.5rem; display: flex; flex-direction: column; gap: 0.25rem;">
                        <li><strong>Upload Gambar:</strong> Buka <a href="https://imgur.com/upload" target="_blank">Imgur.com</a>. Upload foto referensi wajah Anda.</li>
                        <li><strong>Salin Link:</strong> Klik kanan gambar dan pilih <strong>"Copy Image Address"</strong> (Link harus berakhir .jpg, .png, dll).</li>
                        <li><strong>Deskripsikan Karakter:</strong> Isi *textarea* "Detail Karakter" (misal: "Vanno, anak laki-laki, tertawa").</li>
                        <li><strong>Tempel Link:</strong> Tempel link dari Imgur ke kotak <strong>"Link Gambar Referensi Wajah"</strong>.</li>
                    </ol>
                </div>

            </div>
        </div>
    </div>

    <!-- SweetAlert2 (Missing Dependency) -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- FIREBASE SDK (Required for initFirebase) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <!-- INIT FIREBASE (Fix for Local/Prod) -->
    <script type="module">
        import { initFirebase } from '../../js/config.js';
        
        // Wait for config to load
        initFirebase().then(fb => {
             if (fb) {
                 console.log("üî• Firebase Initialized in Generator");
                 window.dispatchEvent(new Event('firebase-ready'));
             } else {
                 console.error("‚ùå Failed to initialize Firebase. Config might be missing.");
             }
        });
    </script>

    <script type="module" src="script.js" defer></script>
</body>
</html>